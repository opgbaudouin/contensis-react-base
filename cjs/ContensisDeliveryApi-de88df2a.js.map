{"version":3,"file":"ContensisDeliveryApi-de88df2a.js","sources":["../src/util/ContensisDeliveryApi.js"],"sourcesContent":["import { Client } from 'contensis-delivery-api';\nimport { parse } from 'query-string';\nimport { setSurrogateKeys } from '../routing/redux/actions';\nimport { reduxStore } from '~/redux/store/store';\n\nconst storeSurrogateKeys = response => {\n  const keys = response.headers.get\n    ? response.headers.get('surrogate-key')\n    : response.headers.map['surrogate-key'];\n  if (keys) reduxStore?.dispatch(setSurrogateKeys(keys, response.url));\n};\n\nexport const getClientConfig = project => {\n  let config = DELIVERY_API_CONFIG; /* global DELIVERY_API_CONFIG */\n  config.responseHandler = {};\n\n  if (project) {\n    config.projectId = project;\n  }\n\n  // we only want the surrogate key header in a server context\n  if (typeof window === 'undefined') {\n    config.defaultHeaders = {\n      'x-require-surrogate-key': true,\n    };\n    config.responseHandler[200] = storeSurrogateKeys;\n  }\n\n  if (\n    typeof window !== 'undefined' &&\n    PROXY_DELIVERY_API /* global PROXY_DELIVERY_API */\n  ) {\n    // ensure a relative url is used to bypass the need for CORS (separate OPTIONS calls)\n    config.rootUrl = '';\n    config.responseHandler[404] = () => null;\n  }\n  return config;\n};\n\nexport * from 'contensis-delivery-api';\n\nclass DeliveryApi {\n  getClientSideVersionStatus = () => {\n    if (typeof window !== 'undefined') {\n      // Allow overriding versionStatus with the querystring\n      const { versionStatus } = parse(window.location.search);\n      if (versionStatus) return versionStatus;\n      // Client-side we will have a global variable set if rendered by SSR in production\n      if (typeof window.versionStatus !== 'undefined')\n        return window.versionStatus;\n      // For localhost development we can only work out versionStatus from the current hostname\n      const currentHostname = window.location.hostname;\n      return this.getVersionStatusFromHostname(currentHostname);\n    }\n    return null;\n  };\n  getServerSideVersionStatus = request =>\n    request.query.versionStatus ||\n    deliveryApi.getVersionStatusFromHeaders(request.headers) ||\n    deliveryApi.getVersionStatusFromHostname(request.hostname);\n  getVersionStatusFromHeaders = headers => {\n    const versionStatusHeader = headers['x-entry-versionstatus'];\n    if (typeof versionStatusHeader !== 'undefined') return versionStatusHeader;\n    return null;\n  };\n  getVersionStatusFromHostname = currentHostname => {\n    if (currentHostname.indexOf('localhost') > -1) return 'latest';\n\n    if (currentHostname.endsWith('contensis.cloud')) {\n      if (currentHostname.indexOf('preview.') > -1) {\n        return 'latest';\n      } else {\n        return 'published';\n      }\n    }\n\n    if (currentHostname.endsWith('cloud.contensis.com')) {\n      if (currentHostname.indexOf('preview-') > -1) {\n        return 'latest';\n      } else {\n        return 'published';\n      }\n    }\n\n    return 'published';\n  };\n  search = (query, linkDepth, project, env) => {\n    const client = Client.create(getClientConfig(project, env));\n    return client.entries.search(\n      query,\n      typeof linkDepth !== 'undefined' ? linkDepth : 1\n    );\n  };\n  getClient = (deliveryApiStatus = 'published', project, env) => {\n    const baseConfig = getClientConfig(project, env);\n    baseConfig.versionStatus = deliveryApiStatus;\n    return Client.create(baseConfig);\n  };\n  getEntry = (\n    id,\n    linkDepth = 0,\n    deliveryApiStatus = 'published',\n    project,\n    env\n  ) => {\n    const baseConfig = getClientConfig(project, env);\n    baseConfig.versionStatus = deliveryApiStatus;\n    const client = Client.create(baseConfig);\n    // return client.entries.get(id, linkDepth);\n    return client.entries.get({ id, linkDepth });\n  };\n}\n\nexport const deliveryApi = new DeliveryApi();\n\nclass CacheNode {\n  constructor(key, value) {\n    this.key = key;\n    this.value = value;\n    this.next = null;\n    this.prev = null;\n  }\n}\n\nclass LruCache {\n  constructor(limit = 100) {\n    this.map = {};\n    this.head = null;\n    this.tail = null;\n    this.limit = limit || 100;\n    this.size = 0;\n  }\n\n  get(key) {\n    if (this.map[key]) {\n      let value = this.map[key].value;\n      let node = new CacheNode(key, value);\n      this.remove(key);\n      this.setHead(node);\n      return value;\n    }\n  }\n\n  set(key, value) {\n    let node = new CacheNode(key, value);\n    if (this.map[key]) {\n      this.remove(key);\n    } else {\n      if (this.size >= this.limit) {\n        delete this.map[this.tail.key];\n        this.size--;\n        this.tail = this.tail.prev;\n        this.tail.next = null;\n      }\n    }\n    this.setHead(node);\n  }\n\n  setHead(node) {\n    node.next = this.head;\n    node.prev = null;\n    if (this.head) {\n      this.head.prev = node;\n    }\n    this.head = node;\n    if (!this.tail) {\n      this.tail = node;\n    }\n    this.size++;\n    this.map[node.key] = node;\n  }\n\n  remove(key) {\n    let node = this.map[key];\n    if (!node) return; // This is sometimes null and crashes the container without this check\n\n    if (node.prev) {\n      node.prev.next = node.next;\n    } else {\n      this.head = node.next;\n    }\n    if (node.next) {\n      node.next.prev = node.prev;\n    } else {\n      this.tail = node.prev;\n    }\n    delete this.map[key];\n    this.size--;\n  }\n}\n\nclass CachedSearch {\n  cache = new LruCache();\n  taxonomyLookup = {};\n\n  search(query, linkDepth, project, env) {\n    const client = Client.create(getClientConfig(project, env));\n    return this.request(\n      project + JSON.stringify(query) + linkDepth.toString(),\n      () => client.entries.search(query, linkDepth)\n    );\n  }\n\n  searchUsingPost(query, linkDepth = 0, project = '', env) {\n    const client = Client.create(getClientConfig(project, env));\n    return this.request(\n      project + JSON.stringify(query) + linkDepth.toString(),\n      () => client.entries.searchUsingPost(query, linkDepth)\n    );\n  }\n\n  get(id, linkDepth, versionStatus, project, env) {\n    const client = Client.create(getClientConfig(project, env));\n    client.clientConfig.versionStatus = versionStatus;\n    return this.request(id, () => client.entries.get({ id, linkDepth }));\n  }\n\n  getContentType(id, project, env) {\n    const client = Client.create(getClientConfig(project, env));\n    return this.request(`[CONTENT TYPE] ${id} ${project}`, () =>\n      client.contentTypes.get(id)\n    );\n  }\n\n  getTaxonomyNode(key, project, env) {\n    const client = Client.create(getClientConfig(project, env));\n    return this.request(`[TAXONOMY NODE] ${key}`, () =>\n      client.taxonomy\n        .resolveChildren(key)\n        .then(node => this.extendTaxonomyNode(node))\n    );\n  }\n\n  getRootNode(options, project, env) {\n    const client = Client.create(getClientConfig(project, env));\n    return this.request(`${project} / ${JSON.stringify(options)}`, () =>\n      client.nodes.getRoot(options)\n    );\n  }\n\n  getNode(options, project, env) {\n    const client = Client.create(getClientConfig(project, env));\n    return this.request(\n      `${project} ${(options && options.path) || options} ${JSON.stringify(\n        options\n      )}`,\n      () => client.nodes.get(options)\n    );\n  }\n\n  getAncestors(options, project, env) {\n    const client = Client.create(getClientConfig(project, env));\n    return this.request(\n      `${project} [A] ${(options && options.id) || options} ${JSON.stringify(\n        options\n      )}`,\n      () => client.nodes.getAncestors(options)\n    );\n  }\n\n  getChildren(options, project, env) {\n    const client = Client.create(getClientConfig(project, env));\n    return this.request(\n      `${project} [C] ${(options && options.id) || options} ${JSON.stringify(\n        options\n      )}`,\n      () => client.nodes.getChildren(options)\n    );\n  }\n\n  getSiblings(options, project, env) {\n    const client = Client.create(getClientConfig(project, env));\n    return this.request(\n      `${project} [S] ${(options && options.id) || options} ${JSON.stringify(\n        options\n      )}`,\n      () => client.nodes.getSiblings(options)\n    );\n  }\n\n  request(key, execute) {\n    if (!this.cache.get(key) || typeof window == 'undefined') {\n      let promise = execute();\n      this.cache.set(key, promise);\n      promise.catch(() => {\n        this.cache.remove(key);\n      });\n    }\n    return this.cache.get(key);\n  }\n}\n\nexport const cachedSearch = new CachedSearch();\n"],"names":["storeSurrogateKeys","response","keys","headers","get","map","reduxStore","dispatch","setSurrogateKeys","url","getClientConfig","project","config","DELIVERY_API_CONFIG","responseHandler","projectId","window","defaultHeaders","PROXY_DELIVERY_API","rootUrl","DeliveryApi","constructor","getClientSideVersionStatus","versionStatus","parse","location","search","currentHostname","hostname","getVersionStatusFromHostname","getServerSideVersionStatus","request","query","deliveryApi","getVersionStatusFromHeaders","versionStatusHeader","indexOf","endsWith","linkDepth","env","client","Client","create","entries","getClient","deliveryApiStatus","baseConfig","getEntry","id","CacheNode","key","value","next","prev","LruCache","limit","head","tail","size","node","remove","setHead","set","CachedSearch","cache","taxonomyLookup","JSON","stringify","toString","searchUsingPost","clientConfig","getContentType","contentTypes","getTaxonomyNode","taxonomy","resolveChildren","then","extendTaxonomyNode","getRootNode","options","nodes","getRoot","getNode","path","getAncestors","getChildren","getSiblings","execute","promise","catch","cachedSearch"],"mappings":"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"}